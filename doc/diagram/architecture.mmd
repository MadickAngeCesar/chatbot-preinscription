---
title: Architecture MVC + Controllers - Chatbot PrÃ©inscription
---

flowchart TB
    subgraph Client["ğŸ‘¤ CLIENT (Browser/App)"]
        Browser[Web Browser]
        API[API Client]
    end

    subgraph FlaskApp["ğŸš€ FLASK APPLICATION"]
        
        subgraph Middlewares["ğŸ›¡ï¸ MIDDLEWARES"]
            direction TB
            Log[Logging Middleware<br/>ğŸ“ Log requests/responses]
            Auth[Auth Middleware<br/>ğŸ” Check session validity]
            Valid[Validation Middleware<br/>âœ“ Validate data]
        end

        subgraph Routes["ğŸš¦ ROUTES (HTTP Layer)"]
            direction LR
            AuthRoutes[auth_routes.py<br/>/api/auth/*]
            APIRoutes[api_routes.py<br/>/api/*]
        end

        subgraph Controllers["ğŸ® CONTROLLERS (Business Logic)"]
            direction TB
            AuthCtrl[auth_controller<br/>register, login, profile]
            ChatCtrl[chat_controller<br/>send_message, history]
            PreinsCtrl[preinscription_controller<br/>create, get, update]
            EtabCtrl[etablissement_controller<br/>get, details, stats]
            FilCtrl[filiere_controller<br/>get, details, by_niveau]
        end

        subgraph ServicesModels["ğŸ”§ SERVICES & MODELS"]
            direction LR
            DB[(Database<br/>SQLite)]
            Gemini[Gemini AI<br/>Chatbot]
            Files[File Storage<br/>uploads/]
        end

        subgraph ErrorHandling["âš ï¸ ERROR HANDLERS"]
            ErrHandler[Error Handler<br/>APIError, 404, 500]
        end
    end

    Browser --> Log
    API --> Log
    
    Log --> Auth
    Auth --> Valid
    Valid --> Routes
    
    AuthRoutes --> AuthCtrl
    APIRoutes --> ChatCtrl
    APIRoutes --> PreinsCtrl
    APIRoutes --> EtabCtrl
    APIRoutes --> FilCtrl
    
    AuthCtrl --> DB
    ChatCtrl --> DB
    ChatCtrl --> Gemini
    PreinsCtrl --> DB
    PreinsCtrl --> Files
    EtabCtrl --> DB
    FilCtrl --> DB
    
    Controllers --> ErrHandler
    ErrHandler --> Client
    
    ServicesModels --> Routes
    Routes --> Client

    style FlaskApp fill:#667eea,stroke:#764ba2,stroke-width:3px,color:#fff
    style Middlewares fill:#10b981,stroke:#059669,stroke-width:2px,color:#fff
    style Routes fill:#f59e0b,stroke:#d97706,stroke-width:2px,color:#fff
    style Controllers fill:#8b5cf6,stroke:#7c3aed,stroke-width:2px,color:#fff
    style ServicesModels fill:#06b6d4,stroke:#0891b2,stroke-width:2px,color:#fff
    style ErrorHandling fill:#ef4444,stroke:#dc2626,stroke-width:2px,color:#fff
    style Client fill:#6366f1,stroke:#4f46e5,stroke-width:2px,color:#fff
